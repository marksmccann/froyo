!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).froyojs={})}(this,(function(t){"use strict";function e(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)}function i(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i}var s,n,r,a,o,c,h;class d{get components(){return{...e(this,s,"f")}}set components(t){Object.entries(t).every((([t,e])=>e instanceof d||(console.error(`Warning: component "${t}" is not an instance of "Component"`),!1)))&&i(this,s,{...t},"f")}get displayName(){const t=this.constructor,{name:e,displayName:i}=t;return i||e}get elements(){return{...e(this,n,"f")}}set elements(t){i(this,n,{...t},"f")}get listeners(){return{...e(this,a,"f")}}set listeners(t){Object.entries(t).every((([t,e])=>"function"==typeof e?.destroy||(console.error(`Warning: listener "${t}" is missing a "destroy" function`),!1)))&&i(this,a,{...t},"f")}get initialized(){return e(this,r,"f")}get rootElement(){return e(this,c,"f")}get state(){return{...e(this,h,"f")}}set state(t){this.initialized?console.error('Warning: state can only be updated via "setState" after initialization'):this.setState(t)}constructor(t,e={}){s.set(this,{}),n.set(this,{}),r.set(this,!1),a.set(this,{}),o.set(this,new Set),c.set(this,void 0),h.set(this,void 0);let d={},u=null;if("string"==typeof t?u=document.body.querySelector(t):t instanceof HTMLElement&&(u=t),!(u instanceof HTMLElement))throw new Error("Warning: the root element must be an HTML element");if(i(this,c,u,"f"),u.hasAttribute("data-initial-state"))try{d=JSON.parse(u.getAttribute("data-initial-state")||"")}catch{console.error('Warning: "data-initial-state" must contain valid JSON')}this.setState({...d,...e}),this.setup&&this.setup(),this.validate&&(this.subscribe(this.validate.bind(this)),this.validate.call(this,this.state,this.state)),this.render&&(this.subscribe(this.render.bind(this)),this.render.call(this,this.state,this.state)),void 0!==this.update&&(this.subscribe(this.update.bind(this)),this.update.call(this,this.state,this.state)),i(this,r,!0,"f")}destroy(){e(this,o,"f").clear(),Object.values(e(this,a,"f")).forEach((t=>{t.destroy()})),Object.values(e(this,s,"f")).forEach((t=>{t.destroy()}))}setState(t){const s=this.constructor,{defaultState:n={},stateTypes:r={}}=s,a=this.state,c={};if(Object.entries(t).forEach((([t,e])=>{e!==a[t]&&(c[t]=e)})),Object.keys(c).length>0||!this.initialized){const t={...a,...c};Object.keys(n).forEach((e=>{void 0===t[e]&&(t[e]=n[e])})),i(this,h,t,"f"),this.initialized&&e(this,o,"f").forEach((t=>{t.call(this,c,a)}))}}subscribe(t){"function"==typeof t?e(this,o,"f").has(t)||e(this,o,"f").add(t):console.error('Warning: a function must be provided to "subscribe"')}unsubscribe(t){e(this,o,"f").has(t)&&e(this,o,"f").delete(t)}}function u(t,e={}){Object.entries(e).forEach((([e,i])=>{null===i?t.removeAttribute(e):void 0!==i&&t.setAttribute(e,i)}))}s=new WeakMap,n=new WeakMap,r=new WeakMap,a=new WeakMap,o=new WeakMap,c=new WeakMap,h=new WeakMap,t.Component=d,t.addEventListener=function(t,e,i,s){return t.addEventListener(e,i,s),{destroy(){t.removeEventListener(e,i,s)}}},t.createElement=function(t,e,i=""){const s=document.createElement(t);return e&&u(s,e),"string"==typeof i?s.innerHTML=i:s.appendChild(i),s},t.createInitializer=function(t){return function(){const e=document.querySelectorAll("[data-initialize]"),i=[];return e.forEach((e=>{const s=e.getAttribute("data-initialize");s&&s in t&&t[s].prototype instanceof d?(e.removeAttribute("data-initialize"),i.push(new t[s](e))):console.error(`Warning: "${s}" is not a valid "Component" constructor`)})),i}},t.createMediaQueryListener=function(t,e){const i=window.matchMedia(t);return i.addEventListener("change",e),{media:i,destroy(){i.removeEventListener("change",e)}}},t.createMutationObserver=function(t,e,i){const s=new MutationObserver(e);return s.observe(t,i),{observer:s,destroy(){s.disconnect()}}},t.setAttributes=u,t.setClasses=function(t,e){Object.entries(e).forEach((e=>{t.classList[e[1]?"add":"remove"](e[0])}))}}));
