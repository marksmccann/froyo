!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).froyojs={})}(this,(function(e){"use strict";const t=Symbol("component");function n(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}function o(e,t,n){"string"==typeof n&&t.innerHTML!==n&&(t.innerHTML=n)}function r(e,t,r){"string"==typeof r?o(0,t,r):n(r)&&(function(e,t,o){n(o)&&Object.entries(o).forEach((([e,n])=>{"string"==typeof n?t.setAttribute(e,n):null===n?t.removeAttribute(e):"boolean"==typeof n&&(n?t.setAttribute(e,""):t.removeAttribute(e))}))}(0,t,r.attributes),function(e,t,o){n(o)&&Object.entries(o).forEach((([e,n])=>{n?t.classList.add(e):t.classList.remove(e)}))}(0,t,r.classes),o(0,t,r.content),function(e,t,n){t instanceof HTMLElement&&"object"==typeof n&&null!==n&&Object.entries(n).forEach((([e,n])=>{"string"==typeof n?t.style.setProperty(e,n):null===n&&t.style.removeProperty(e)}))}(0,t,r.style))}function s(e,t){const n=this[e],o=Array.isArray(n);let s=[];o?s=n:null!==n&&s.push(n),s.forEach(((e,n)=>{const s=o?n:void 0,c=t.call(this,s);e instanceof Text?function(e,t,n){"string"==typeof n&&t.nodeValue!==n&&(t.nodeValue=n)}(0,e,c):r(0,e,c)}))}e.createInitializer=function(e){return function(){const n=document.querySelectorAll("[data-init]"),o=[];return n.forEach((n=>{const r=n.getAttribute("data-init")||"",s=e[r];r in e&&s.$$typeof===t&&(n.removeAttribute("data-initialize"),o.push(new s(n)))})),o}},e.defineComponent=function(e){var n;const o=new Set,r=new Map,c=new Set,a=new Set,i=new Set,l={};let f=!1;const u={name:e.name||"Unnamed component",state:e.state||{},nodes:e.nodes||{},methods:e.methods||{},components:e.components||{},events:e.events||{},render:e.render||{},hooks:e.hooks||{}};return l.$state=new Proxy({},{set(e,t,n){const o=e[t];let d=n!==o,y=n;if(void 0===y&&(y=u.state[t].default,d=y!==o),e[t]=y,f&&d){const e=r.get(t);c.forEach((([e,t])=>{s.call(l,e,t)})),e&&e.call(l,n,o),i.forEach((([e,r])=>{t===e&&r.call(void 0,n,o)}))}return(!f||f&&d)&&a.forEach((([e,t])=>{const{state:n}=u.components[e].call(l);n&&t.setState(n)})),!0}}),(n=class{static get displayName(){return u.name}get root(){return l.$root}get state(){return{...l.$state}}constructor(e,n={}){let i=null,d={};if("string"==typeof e?i=document.querySelector(e):e instanceof Element&&(i=e),!i)throw new Error("An unknown error has ocurred");l.$root=i;try{const e=i.getAttribute("data-state");null!==e&&(d=JSON.parse(e))}catch{}Object.entries(u.state).forEach((([e,t])=>{let o;e in d&&(o=d[e]),e in n&&(o=n[e]),void 0!==o&&t.readonly||(l.$state[e]=o)})),Object.entries(u.nodes).forEach((([e,t])=>{const{type:n}=t;let o=null;if("text"===n)o=document.createTextNode(t.value||"");else if("element"===n&&t.tagName){const{className:e,attributes:n={},content:r}=t;o=document.createElement(t.tagName),e&&o.classList.add(e),r&&(o.innerHTML=r),Object.entries(n).forEach((e=>{o.setAttribute(...e)}))}else if("svg"===n&&t.tagName){const{className:e,attributes:n={},content:r}=t;o=document.createElementNS("http://www.w3.org/2000/svg",t.tagName),e&&o.classList.add(e),r&&(o.innerHTML=r),Object.entries(n).forEach((e=>{o.setAttribute(...e)}))}else if("query"===n&&t.selector){const{selector:e,optional:n}=t;let r=l.$root;t.scope&&(r=t.scope(l.$root)),o=r.querySelector(e)}else if("query-all"===n&&t.selector){const{selector:e,optional:n}=t;let r=l.$root;t.scope&&(r=t.scope(l.$root)),o=Array.from(r.querySelectorAll(e)),o.length}else if("custom"===n&&"function"==typeof t.node){const e=t.node.call(void 0,l.$root);o=e instanceof NodeList||e instanceof HTMLCollection?Array.from(e):e}l[e]=o})),Object.entries(u.methods).forEach((([e,t])=>{"function"==typeof t&&(l[e]=t.bind(l))})),Object.entries(u.components).forEach((([e,n])=>{const r=n.call(l),{constructor:s,subscribe:c}=r;if(s.$$typeof===t){const t=new s(r.root,r.state);c&&Object.entries(c).forEach((([e,n])=>{"function"==typeof n?t.subscribe(e,n):(u.name,s.displayName)})),a.add([e,t]),o.add((()=>t.destroy()))}})),Object.entries(u.events).forEach((([e,t])=>{let n=[];const r=l[e];"$window"===e?n.push(window):"$document"===e?n.push(document):Array.isArray(r)?n=r:r&&n.push(r),n.forEach(((e,n)=>{let s;s=Array.isArray(r)?t.call(l,n):t.call(l),o.add(function(e,t,n){const o=new Set;return Object.entries(n).forEach((([e,n])=>{const r=/^(focus|blur)$/.test(e);"function"==typeof n&&(t.addEventListener(e,n,r),o.add((()=>{t.removeEventListener(e,n,r)})))})),()=>{o.forEach((e=>e()))}}(0,e,s))}))})),Object.entries(u.hooks).forEach((([e,t])=>{if("$setup"===e)t.call(l);else if("$teardown"===e)o.add(t.bind(l));else if(e in u.state){const n=l.$state[e];r.set(e,t),t.call(l,n,n)}})),Object.entries(u.render).forEach((([e,t])=>{e in l&&(c.add([e,t]),s.call(l,e,t))})),f=!0}destroy(){o.forEach((e=>e()))}setState(e){Object.entries(e).forEach((([e,t])=>{e in u.state&&(u.state[e].readonly||(l.$state[e]=t))}))}subscribe(e,t){if(!(e in u.state))return;if("function"!=typeof t)return;Array.from(i).find((n=>n[0]===e&&n[1]===t))||i.add([e,t])}unsubscribe(e,t){if(!(e in u.state))return;if("function"!=typeof t)return;const n=Array.from(i).find((n=>n[0]===e&&n[1]===t));n&&i.delete(n)}}).$$typeof=t,n}}));
