!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).froyojs={})}(this,(function(t){"use strict";function e(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)}function i(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i}var s,n,r,a,o,h;class c{get components(){return Object.fromEntries(e(this,s,"f"))}set components(t){Object.entries(t).forEach((([t,i])=>{var n;i instanceof c?(e(this,s,"f").has(t)&&(null===(n=e(this,s,"f").get(t))||void 0===n||n.destroy()),e(this,s,"f").set(t,i)):console.error(`Warning: component "${t}" is not an instance of "Component"`)}))}get displayName(){const{name:t,displayName:e}=this.constructor;return null!=e?e:t}get listeners(){return Object.fromEntries(e(this,r,"f"))}set listeners(t){Object.entries(t).forEach((([t,i])=>{var s;"function"==typeof(null==i?void 0:i.destroy)?(e(this,r,"f").has(t)&&(null===(s=e(this,r,"f").get(t))||void 0===s||s.destroy()),e(this,r,"f").set(t,i)):console.error(`Warning: listener "${t}" is missing a "destroy" function`)}))}get initialized(){return e(this,n,"f")}get rootElement(){return e(this,h,"f")}get state(){return Object.assign({},e(this,o,"f"))}set state(t){this.initialized?console.error('Warning: state can only be updated via "setState" after initialization'):this.setState(t)}constructor(t,e={}){var c;s.set(this,new Map),n.set(this,!1),r.set(this,new Map),a.set(this,new Set),o.set(this,{}),h.set(this,void 0),this.update=()=>{},this.validate=()=>{};let d={};if(t instanceof Element)if(this.render){if(t.hasAttribute("data-initial-state"))try{d=JSON.parse(null!==(c=t.dataset.initialState)&&void 0!==c?c:"")}catch(t){console.error('Warning: "data-initial-state" must contain valid JSON')}i(this,h,t,"f"),this.setState(Object.assign(Object.assign({},d),e)),this.initialize(),this.initialize=this.initialize.bind(this),this.validate=this.validate.bind(this),this.render=this.render.bind(this),this.update=this.update.bind(this),this.subscribe(this.validate),this.subscribe(this.render),this.subscribe(this.update),this.validate(this.state,{},this),this.render(this.state,{},this),this.update(this.state,{},this),i(this,n,!0,"f")}else console.error('Warning: components must have a "render" method');else console.error("Warning: the root element must be an HTML element")}destroy(){e(this,a,"f").clear(),e(this,r,"f").forEach((t=>t.destroy())),e(this,s,"f").forEach((t=>t.destroy()))}setState(t){const{displayName:s,defaultState:n={},stateTypes:r={}}=this.constructor,h=this.state,c={};if(Object.entries(t).forEach((([t,e])=>{e!==h[t]&&(c[t]=e)})),Object.keys(c).length>0||!this.initialized){const t=Object.assign(Object.assign({},h),c);Object.keys(n).forEach((e=>{void 0===t[e]&&(t[e]=n[e])})),i(this,o,t,"f"),this.initialized&&e(this,a,"f").forEach((t=>{t(c,h,this)}))}}subscribe(t){"function"==typeof t?e(this,a,"f").has(t)||e(this,a,"f").add(t):console.error('Warning: a function must be provided to "subscribe"')}unsubscribe(t){e(this,a,"f").has(t)&&e(this,a,"f").delete(t)}initialize(){}}function d(t,e){Object.entries(null!=e?e:{}).forEach((([e,i])=>{null===i?t.removeAttribute(e):t.setAttribute(e,i)}))}s=new WeakMap,n=new WeakMap,r=new WeakMap,a=new WeakMap,o=new WeakMap,h=new WeakMap,t.Component=c,t.addEventListener=function(t,e,i,s){return t.addEventListener(e,i,s),{destroy(){t.removeEventListener(e,i,s)}}},t.createElement=function(t,e={},i=""){const s=document.createElement(t);return d(s,e),"string"==typeof i?s.innerHTML=i:s.appendChild(i),s},t.createMediaQueryListener=function(t,e,i){const s=window.matchMedia(t);return s.addEventListener("change",e,i),{media:s,destroy(){s.removeEventListener("change",e,i)}}},t.createMutationObserver=function(t,e,i){const s=new MutationObserver(e);return s.observe(t,i),{observer:s,destroy(){s.disconnect()}}},t.querySelectorAll=function(t,e){return Array.from(t.querySelectorAll(e))},t.setAttributes=d}));
//# sourceMappingURL=froyojs.min.js.map
