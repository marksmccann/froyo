!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).froyojs={})}(this,(function(t){"use strict";function e(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,n(t,e,"get"))}function i(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,n(t,e,"set"),i),i}function n(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function s(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}const r=new Set;var a=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,h=new WeakMap,u=new WeakMap,d=new WeakMap;class f{static get instances(){return Array.from(r)}get components(){return Object.fromEntries(e(this,a))}set components(t){Object.entries(t).forEach((t=>{let[i,n]=t;n instanceof f?(e(this,a).has(i)&&e(this,a).get(i).destroy(),e(this,a).set(i,n)):console.error(`Warning: component "${i}" is not an instance of "Component"`)}))}get displayName(){const{name:t,displayName:e}=this.constructor;return e||t}get elements(){return{...e(this,o)}}set elements(t){Object.entries(t).forEach((t=>{let[i,n]=t;n instanceof Node||null===n?e(this,o)[i]=n:n instanceof NodeList||n instanceof HTMLCollection?e(this,o)[i]=Array.from(n):console.error(`Warning: value assigned to "elements.${i}" is not a valid DOM node`)}))}get listeners(){return Object.fromEntries(e(this,l))}set listeners(t){Object.entries(t).forEach((t=>{let[i,n]=t;"function"==typeof n?.destroy?(e(this,l).has(i)&&e(this,l).get(i).destroy(),e(this,l).set(i,n)):console.error(`Warning: listener "${i}" is missing a "destroy" function`)}))}get initialized(){return e(this,c)}get rootElement(){return e(this,u)}get state(){return{...e(this,d)}}set state(t){this.initialized?console.error('Warning: state can only be updated via "setState" after initialization'):this.setState(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(this,a,{writable:!0,value:new Map}),s(this,o,{writable:!0,value:{}}),s(this,c,{writable:!0,value:!1}),s(this,l,{writable:!0,value:new Map}),s(this,h,{writable:!0,value:new Set}),s(this,u,{writable:!0,value:null}),s(this,d,{writable:!0,value:{}});let n={},f=t;if("string"==typeof f&&(f=document.body.querySelector(t)),f instanceof Element)if(this.render){if(f.hasAttribute("data-initial-state"))try{n=JSON.parse(f.getAttribute("data-initial-state"))}catch{console.error('Warning: "data-initial-state" must contain valid JSON')}i(this,u,f),this.setup=this.setup.bind(this),this.validate=this.validate.bind(this),this.render=this.render.bind(this),this.update=this.update.bind(this),this.subscribe(this.validate),this.subscribe(this.render),this.subscribe(this.update),this.setState({...n,...e}),this.setup(),this.validate(this.state,{},this),this.render(this.state,{},this),this.update(this.state,{},this),i(this,c,!0),r.add(this)}else console.error('Warning: components must have a "render" method');else console.error("Warning: the root element must be an HTML element")}destroy(){e(this,h).clear(),e(this,l).forEach((t=>t.destroy())),e(this,a).forEach((t=>t.destroy())),r.delete(this)}setState(t){const{defaultState:n={},stateTypes:s={}}=this.constructor,r=this.state,a={};if(Object.entries(t).forEach((t=>{let[e,i]=t;i!==r[e]&&(a[e]=i)})),Object.keys(a).length>0||!this.initialized){const t={...r,...a};Object.keys(n).forEach((e=>{void 0===t[e]&&(t[e]=n[e])})),i(this,d,t),this.initialized&&e(this,h).forEach((t=>{t(a,r,this)}))}}subscribe(t){"function"==typeof t?e(this,h).has(t)||e(this,h).add(t):console.error('Warning: a function must be provided to "subscribe"')}unsubscribe(t){e(this,h).has(t)&&e(this,h).delete(t)}setup(){}validate(){}update(){}}function p(t,e){Object.entries(e??{}).forEach((e=>{let[i,n]=e;null===n?t.removeAttribute(i):void 0!==n&&t.setAttribute(i,n)}))}t.Component=f,t.addEventListener=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return t.addEventListener(...i),{destroy(){t.removeEventListener(...i)}}},t.createElement=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const n=document.createElement(t);return p(n,e),"string"==typeof i?n.innerHTML=i:n.appendChild(i),n},t.createInitializer=function(t){return function(){const e=document.querySelectorAll("[data-initialize]"),i=[];return Array.from(e).forEach((e=>{const n=e.getAttribute("data-initialize"),s=t[n];s.prototype instanceof f?(e.removeAttribute("data-initialize"),i.push(new s(e))):console.error(`Warning: "${n}" is not a valid "Component" constructor`)})),i}},t.createMediaQueryListener=function(t,e){const i=window.matchMedia(t);return i.addEventListener("change",e),{media:i,destroy(){i.removeEventListener("change",e)}}},t.createMutationObserver=function(t,e,i){const n=new MutationObserver(e);return n.observe(t,i),{observer:n,destroy(){n.disconnect()}}},t.setAttributes=p}));
